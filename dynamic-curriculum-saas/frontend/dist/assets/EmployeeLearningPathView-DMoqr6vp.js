import{c as o,o as s,a as t,t as y,F as k,s as L,x as S,h as P,g,n as E,j as $,q as w,d as N}from"./index-DyemIcl1.js";import{u as B,l as b}from"./employeeStore-CnIk7pTv.js";import{_ as T}from"./PathStep-DRU-gob9.js";const C={class:"p-4 space-y-4"},D={class:"text-xl font-semibold text-gray-800"},F={key:0,class:"text-center py-8"},V={key:1,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert"},Y={class:"block sm:inline"},A={key:2,class:"space-y-3"},j={key:3},I={__name:"PathDisplay",props:{pathSteps:Array,pathTitle:String,isLearnerView:{type:Boolean,default:!1},isLoading:Boolean,error:String},emits:["step-completion-toggled"],setup(n,{emit:h}){const u=h,v=(e,r)=>{u("step-completion-toggled",e,r)};return(e,r)=>(s(),o("div",C,[t("h3",D,y(n.pathTitle||"Your Learning Path"),1),n.isLoading?(s(),o("div",F,r[0]||(r[0]=[t("p",{class:"text-gray-600"},"Loading learning path...",-1)]))):n.error?(s(),o("div",V,[r[1]||(r[1]=t("strong",{class:"font-bold"},"Error!",-1)),t("span",Y,y(n.error),1)])):n.pathSteps&&n.pathSteps.length>0?(s(),o("div",A,[(s(!0),o(k,null,L(n.pathSteps,(l,i)=>(s(),S(T,{key:l.topic+i,"step-data":l,index:i,"is-learner-view":n.isLearnerView,"is-editable":!1,onToggleComplete:v},null,8,["step-data","index","is-learner-view"]))),128))])):(s(),o("div",j,r[2]||(r[2]=[t("p",{class:"text-gray-600"},"No steps found in this learning path, or the path is not yet assigned.",-1)])))]))}},M={class:"container mx-auto p-4"},q={key:0,class:"text-center py-10"},G={key:1,class:"bg-red-100 border-red-400 text-red-700 px-4 py-3 rounded"},R={key:2},z={key:3},H={key:4},J={class:"card text-center py-10"},K={class:"text-gray-700"},O={key:5,class:"card text-center py-10"},X={__name:"EmployeeLearningPathView",setup(n){const h=$(),u=B(),v=P(),e=g(null),r=g(""),l=g(!0),i=g(null),m=E(()=>h.params.pathId),x=async()=>{var p,a,d,f;l.value=!0,i.value=null;try{const c=await b.getLearningPathForEmployee(m.value);e.value=c.data,v.isLdManager&&u.currentEmployee&&u.currentEmployee.id==m.value?r.value=u.currentEmployee.name:r.value=((a=(p=e.value)==null?void 0:p.employee)==null?void 0:a.name)||"this path"}catch(c){console.error("Error fetching learning path for learner:",c),i.value=((f=(d=c.response)==null?void 0:d.data)==null?void 0:f.message)||"Could not load the learning path.",e.value=null}finally{l.value=!1}};w(()=>{m.value?x():(i.value="No path identifier provided.",l.value=!1)});const _=async(p,a)=>{if(!(!e.value||!e.value.id)){l.value=!0;try{const d=await b.updateStepStatus(e.value.id,p,a);e.value=d.data}catch(d){console.error("Error updating step status for learner:",d),alert("Failed to update progress. Please try again."),await x()}finally{l.value=!1}}};return(p,a)=>(s(),o("div",M,[l.value?(s(),o("div",q,a[0]||(a[0]=[t("p",{class:"text-gray-600"},"Loading your learning path...",-1)]))):i.value?(s(),o("div",G,[t("p",null,"Error loading learning path: "+y(i.value),1),a[1]||(a[1]=t("p",null,"Please contact your L&D manager or try again later.",-1))])):e.value&&e.value.path_data&&e.value.status==="assigned"||e.value.status==="in_progress"?(s(),o("div",R,[N(I,{"path-steps":e.value.path_data,"path-title":`Your Learning Path: ${r.value}`,"is-learner-view":!0,onStepCompletionToggled:_},null,8,["path-steps","path-title"])])):e.value&&e.value.status==="draft"?(s(),o("div",z,a[2]||(a[2]=[t("div",{class:"card text-center py-10"},[t("h2",{class:"text-2xl font-semibold text-gray-700 mb-3"},"Path Not Yet Assigned"),t("p",{class:"text-gray-600"},"Your learning path is still being prepared by your L&D manager."),t("p",{class:"text-gray-600"},"Please check back later.")],-1)]))):e.value&&e.value.status==="completed"?(s(),o("div",H,[t("div",J,[a[3]||(a[3]=t("h2",{class:"text-2xl font-semibold text-green-600 mb-3"},"ðŸŽ‰ Congratulations! ðŸŽ‰",-1)),t("p",K,"You have completed your learning path for "+y(r.value)+".",1),a[4]||(a[4]=t("p",{class:"text-gray-600"},"Great job!",-1))])])):(s(),o("div",O,a[5]||(a[5]=[t("h2",{class:"text-2xl font-semibold text-gray-700 mb-3"},"No Learning Path Found",-1),t("p",{class:"text-gray-600"},"A learning path has not been assigned to you yet, or it may not exist.",-1),t("p",{class:"text-gray-600"},"Please contact your L&D manager.",-1)])))]))}};export{X as default};
